(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["table"],{"06fa":function(e,n,t){},3830:function(e,n,t){"use strict";t.r(n);var i,a,o=t("2877"),r={},s=Object(o["a"])(r,i,a,!1,null,null,null);n["default"]=s.exports},"45ff":function(e,n,t){},a422:function(e,n,t){"use strict";t("06fa")},a850:function(e,n,t){"use strict";t("45ff")},caaf:function(e,n,t){"use strict";t.r(n);var i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"lzx_container"},[t("div",{attrs:{id:"view3d"}}),t("div",{attrs:{id:"view2d"}}),t("div",{attrs:{id:"side"}},[t("div",{staticClass:"drawing-list"},[t("div",{staticClass:"title"},[e._v("\n                导出的图纸\n            ")]),t("ul",{staticClass:"detail"},e._l(e.layerList,(function(n,i){return t("li",{key:i,class:{active:n.viewInfo.id==e.nowIndex},on:{click:function(t){return e.load2D(n.viewInfo.id)}}},[e._v("\n                    "+e._s(n.viewInfo.name)+"\n                ")])})),0)]),t("div",{staticClass:"drawing-list"},[t("div",{staticClass:"title"},[t("span",[e._v("批注")]),e.isEdit?e._e():t("div",{staticClass:"newButton"},[t("a",{attrs:{href:"javascript:void(0)"}},[e._v("添加批注")])])]),e._m(0)])])])},a=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ul",{staticClass:"detail"},[t("li",[e._v("1")]),t("li",[e._v("2")]),t("li",[e._v("3")]),t("li",[e._v("4")]),t("li",[e._v("5")])])}],o={data:function(){return{viewToken:String,layerList:null,nowIndex:null}},mounted:function(){var e,n=this,t="70c3b2ecb2584d639c441062e740cc87";n.viewToken=t;var i=new BimfaceSDKLoaderConfig;function a(i){var a=document.getElementById("view3d"),o=new Glodon.Bimface.Application.WebApplication3DConfig;o.domElement=a,o.enableViewhouse=!1,window.app=new Glodon.Bimface.Application.WebApplication3D(o),app.addView(t),app.addEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.MouseClicked,(function(n){var t=e.toDrawingId(n.objectId);t&&(e._drawingViewer.zoomToObject(t),e._drawingViewer.update())})),app.addEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ViewAdded,(function(){app.render(),window.viewer3D=app.getViewer(),viewer3D.getDrawingsheets((function(e){console.log(e),n.layerList=e})),window.onresize=function(){viewer3D.resize(document.documentElement.clientWidth,document.documentElement.clientHeight-40)},n.load2D()}))}function o(e){console.log(e)}i.viewToken=t,BimfaceSDKLoader.load(i,a,o)},methods:{load2D:function(e){var n=new BimfaceSDKLoaderConfig,t=this,i=t.viewToken;function a(n){var a=document.getElementById("view2d");a.innerHTML="";var o=new Glodon.Bimface.Viewer.ViewerDrawingConfig;o.domElement=a;var r=new Glodon.Bimface.Viewer.ViewerDrawing(o);e?(t.nowIndex=e,r.load(i,e)):(t.nowIndex=t.layerList[0].viewInfo.id,r.load(i,t.layerList[0].viewInfo.id)),r.addEventListener(Glodon.Bimface.Viewer.ViewerDrawingEvent.ComponentsSelectionChanged,(function(e){if(e.length>0){var n=r.toModelId(e[0]);viewer3D.clearIsolation(),viewer3D.setSelectedComponentsById([n]);var t=viewer3D.getViewer().getComponentInfoByUserId(n);t?(viewer3D.isolateComponentsById([n],Glodon.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),viewer3D.zoomToSelectedComponents()):(viewer3D.clearIsolation(),viewer3D.render())}}))}function o(e){console.log(e)}n.viewToken=i,n.viewType=BimfaceViewTypeOption.DrawingView,BimfaceSDKLoader.load(n,a,o)}}},r=o,s=(t("a850"),t("2877")),l=Object(s["a"])(r,i,a,!1,null,null,null);n["default"]=l.exports},cd88:function(e,n,t){"use strict";t.r(n);var i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"lzx_container"}},[t("div",{attrs:{id:"modelView"}}),t("div",{attrs:{id:"side2D"}},[t("div",{staticClass:"item2D"},[e.isEdit?e._e():t("div",{staticClass:"title"},[t("span",[e._v("图纸")])]),e.isEdit?e._e():t("div",{staticClass:"content"},[t("ul",{staticClass:"drawinglist"},e._l(e.drawingFrame,(function(n,i){return t("li",{key:i},[t("div",[e._v(e._s(n.name))]),e._l(n.model,(function(a,o){return t("div",{key:o,staticClass:"detail",attrs:{title:a.name}},[t("div",{staticClass:"name",class:{on:"d"+i+"m"+o==e.nowIndex},on:{click:function(t){return e.loadFrame("d"+i+"m"+o,n.viewToken,a.id)}}},[e._v("\n                                "+e._s(a.name)+"\n                            ")]),t("div",[e._v(e._s(a.number))])])}))],2)})),0)])]),t("div",{staticClass:"item2D"},[t("div",{staticClass:"title"},[t("span",[e._v("批注")]),e.isEdit?e._e():t("div",{staticClass:"newButton"},[t("a",{class:{"btn-disable2":e.isView},attrs:{href:"javascript:void(0)"},on:{click:e.createAnnotation}},[e._v("添加批注")])])]),e.isEdit?e._e():t("div",{staticClass:"content contentB"},[e.isEdit?e._e():t("ul",{staticClass:"annotationlist",staticStyle:{"max-height":"calc(100% - 352px)"}},e._l(e.annotationlist,(function(n,i){return t("li",{key:i,class:{on:n.isClick},attrs:{title:n.name},on:{click:function(t){return e.annotationGetImage(i,n)}}},[t("img",{staticClass:"annotation-img",staticStyle:{width:"80px",height:"60px"},attrs:{src:n.src,alt:""}}),t("div",{staticClass:"info"},[n.name.length>0?t("p",{staticClass:"name"},[e._v(e._s(n.name))]):t("p",{staticClass:"name"},[e._v("-")]),t("p",[e._v(e._s(n.time))]),t("p",[e._v("图名："+e._s(n.dwgname))]),t("p",[e._v("图号："+e._s(n.number))])])])})),0)]),e.isEdit?t("div",{staticClass:"edit contentB",class:{"side-isedit":e.isEdit}},[t("div",{staticClass:"annotation-brief"},[t("p",[e._v("图名："+e._s(this.nowName))]),t("p",[e._v("图号："+e._s(this.nowNumber))])]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],attrs:{placeholder:"添加批注描述"},domProps:{value:e.comment},on:{input:function(n){n.target.composing||(e.comment=n.target.value)}}}),t("a",{staticClass:"btn btn-sm btn-primary",attrs:{href:"javascript:void(0)"},on:{click:e.annotationSave}},[e._v("保存")]),t("a",{staticClass:"btn btn-sm btn-default",attrs:{href:"javascript:void(0)"},on:{click:e.annotationCancel}},[e._v("取消")])]):e._e()]),e.isView?t("div",{staticClass:"mask"},[t("a",{staticClass:"btn btn-exit",attrs:{href:"javascript:void(0)"},on:{click:e.maskExit}},[e._v("退出")])]):e._e()])])},a=[];function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}t("ac6a"),t("28a5"),t("7f7f");var r,s={data:function(){return{cHeight:null,viewToken:null,loaded:!1,isEdit:!1,isView:!1,state:null,comment:"",annotationlist:[],dwgViewer:{toolbar:null,annotationManager:null,annotationToolbar:null,annotationControl:null},drawingFrame:null,isAllLoaded:!1,nowIndex:null,nowName:null,nowNumber:null,listStorage:[[[]]],layerStatus:null}},mounted:function(){var e=this,n="10c649e8832743119d856e00ff9aea0e",t=new BimfaceSDKLoaderConfig;function i(e){var t=document.getElementById("modelView"),i=new Glodon.Bimface.Application.WebApplicationDrawingConfig;i.domElement=t,window.app=new Glodon.Bimface.Application.WebApplicationDrawing(i),app.load(n),window.viewer2D=app.getViewer(),o(e,n)}function a(e){console.log(e)}function o(n,t){var i=Glodon.Bimface.Viewer.ViewerDrawingEvent;viewer2D.addEventListener(i.Loaded,(function(){e.loaded=!0,e.drawingFrame||viewer2D.getDrawingFrame((function(i){e.drawingFrame=[{viewToken:t,name:n.name,model:i.data[0].frames}],viewer2D.destroy(),e.loadDwg()})),window.onresize=function(){viewer2D.resize(document.documentElement.clientWidth,document.documentElement.clientHeight-40)};viewer2D.getRootElement()}))}t.viewToken=n,BimfaceSDKLoader.load(t,i,a)},methods:(r={loadDwg:function(){var e=this,n="10c649e8832743119d856e00ff9aea0e",t=new BimfaceSDKLoaderConfig;function i(t){viewer2D.destroy(),app.load(n),viewer2D.addEventListener(Glodon.Bimface.Viewer.ViewerDrawingEvent.Loaded,(function(){if(!e.isAllLoaded){viewer2D.getDrawingFrame((function(i){var a={viewToken:n,name:t.name,model:i.model};e.drawingFrame.push(a),e.isAllLoaded=!0}));var i=e.drawingFrame[0].viewToken,a=e.drawingFrame[0].model[0].id;e.loadFrame("d0m0",i,a),console.log("drawingFrame",e.drawingFrame)}e.defaultAnnotation()}))}function a(e){console.log(e)}t.viewToken=n,BimfaceSDKLoader.load(t,i,a)},loadFrame:function(e,n,t){var i=this;if(!i.isView){if(i.isAllLoaded)i.nowIndex.split("")[1],i.nowIndex.split("")[3];i.nowIndex=e,viewer2D.destroy(),app.loadFrame(n,t),viewer2D.addEventListener(Glodon.Bimface.Viewer.ViewerDrawingEvent.Loaded,(function(){i.defaultAnnotation();var e=i.nowIndex.split("")[1],n=i.nowIndex.split("")[3];i.nowName=i.drawingFrame[e].model[n].name,i.nowNumber=i.drawingFrame[e].model[n].number}))}},defaultAnnotation:function(){var e=this;if(e.clearToolDom(),e.dwgViewer.annotationManager=null,!e.dwgViewer.annotationManager){var n=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbarConfig;n.viewer=viewer2D;var t=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbar(n);e.dwgViewer.annotationToolbar=t,e.dwgViewer.annotationManager=t.getAnnotationManager(),e.defaultAnnotationList()}},defaultAnnotationList:function(){var e=this;e.annotationlist=[];var n=e.nowIndex.split("")[1],t=e.nowIndex.split("")[3];sessionStorage.annotationList&&(e.listStorage=JSON.parse(sessionStorage.annotationList)),e.listStorage[n][t].forEach((function(n){e.dwgViewer.annotationManager.setAnnotationList(n.status),e.dwgViewer.annotationManager.createSnapshot((function(t){var i,a=new Date,o="-",r=":",s=a.getMonth()+1,l=a.getDate(),d=a.getFullYear()+o+s+o+l+" "+a.getHours()+r+a.getMinutes()+r+a.getSeconds();i=n.img?n.img:t;var c={name:n.name,time:d,src:i,state:n.status,isClick:!1,dwgname:e.nowName,number:e.nowNumber};e.annotationlist.push(c)}))})),e.annotationCancel()},createAnnotation:function(){this.isView||(this.isEdit=!0,this.state=[],this.comment="",this.changeModel(1),this.dwgViewer.annotationToolbar.show())},changeModel:function(e){0==e?app.getToolbar("MainToolbar").show():app.getToolbar("MainToolbar").hide()},annotationSave:function(){var e=this,n=e.dwgViewer.annotationManager.getCurrentState();if(0==n.annotationList.length){var t={rotation:0,markupType:"Cross",drawPoints:[0,0],strokeStyle:"rgba(0,0,0,0)",lineWidth:0,bNeedHitByBbox:!1,drawEnd:!0,markupId:""};n.annotationList.push(t)}e.dwgViewer.annotationManager.createSnapshot((function(t){var i=new Date,a="-",o=":",r=i.getMonth()+1,s=i.getDate(),l=i.getFullYear()+a+r+a+s+" "+i.getHours()+o+i.getMinutes()+o+i.getSeconds(),d=t,c={name:e.comment,time:l,src:d,state:n,isClick:!1,dwgname:e.nowName,number:e.nowNumber};e.annotationlist.push(c);var w=e.nowIndex.split("")[1],u=e.nowIndex.split("")[3],m={name:e.comment,img:d,status:n};void 0===e.listStorage[w][u]||null===e.listStorage[w][u]?(e.listStorage[w][u]=[],console.log(e.listStorage[w][u]),e.listStorage[w][u].push(m)):e.listStorage[w][u].push(m),sessionStorage.annotationList=JSON.stringify(e.listStorage)})),e.annotationCancel()},annotationCancel:function(){this.dwgViewer.annotationManager.endDrawing(),this.isEdit=!1,this.changeModel(0),document.querySelector(".bf-annotation").addClass("bf-hide")},clearToolDom:function(){var e=document.querySelector("#markupVirtual");e&&e.parentNode.removeChild(e);var n=document.querySelector(".bf-toolbar-control");n&&n.parentNode.removeChild(n);var t=document.querySelector(".bf-annotation");t&&t.parentNode.removeChild(t)}},o(r,"createAnnotation",(function(){this.isView||(this.isEdit=!0,this.state=[],this.comment="",this.changeModel(1),this.dwgViewer.annotationToolbar.show(),document.querySelector(".bf-toolbar-control").style.display="none")})),o(r,"annotationGetImage",(function(e,n){var t,i=this,a=i.nowIndex.split("")[1],o=i.nowIndex.split("")[3];i.isEdit||(i.isView=!0,i.clearListStyle(),i.changeModel(1),n.isClick=!0,i.dwgViewer.annotationManager.setState(n.state),i.listStorage[a][o][e].img||i.dwgViewer.annotationManager.createSnapshot((function(n){t=n;var a=i.annotationlist;a[e].src=t,i.annotationList=a;var o=document.querySelectorAll(".annotation-img");o[e].setAttribute("src",t)})))})),o(r,"clearListStyle",(function(){for(var e=0;e<this.annotationlist.length;e++)this.annotationlist[e].isClick=!1})),o(r,"maskExit",(function(){this.isView=!1,this.clearListStyle(),this.changeModel(0),this.dwgViewer.annotationManager.startDrawing(),this.dwgViewer.annotationManager.endDrawing()})),r)},l=s,d=(t("a422"),t("2877")),c=Object(d["a"])(l,i,a,!1,null,null,null);n["default"]=c.exports},f02c:function(e,n,t){"use strict";t.r(n);var i,a,o=t("2877"),r={},s=Object(o["a"])(r,i,a,!1,null,null,null);n["default"]=s.exports}}]);